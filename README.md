
```
用三种开发方式将后端部分写三遍

  原生Node.js

  Express.js

  Koa2.js
```

# note

### 从浏览器输入URL到显示页面的整个流程

- 域名经过DNS解析成ip地址 , ip地址对应一台服务器 , 客户端与服务器之间建立TCP链接( 三次握手 ) , 客户端发送http请求

- server端接收到http请求 , 处理并返回

- 客户端接收到返回数据再处理数据( 如页面渲染 , 执行js )

### server开发和前端开发的区别

- 服务稳定性

  - server端可能会遭受各种恶意攻击和误操作

  - 单个客户端可以意外挂掉 , 但是服务端不能

  - 本次学习使用PM2做进程守护( 进程一旦挂掉就会自动重启而不用人工干预 )

- 考虑内存和CPU( 优化、扩展 )

  - 客户端独占一个浏览器 , 内存和CPU都不是问题

  - server端要承载很多请求 , CPU和内存都是稀缺资源

  - 本次学习使用stream记录日志 , 这种记录日志的方法十分解决CPU和内存 , 是一种优化方案
  
  - 本次学习使用redis存储session , 是扩展server端承载能力的一种方法

- 日志记录

  - 前端会参与写日志 , 但只是日志的发起方 , 不关心后续

  - server端要
    - 记录日志
    - 存储日志
    - 分析日志

  - 本次学习了多种记录日志的方法 , 也学习了如何分析日志

- 安全

  - server端要随时准备接收各种恶意攻击 , 前端则少很多 , 如越权操作、数据库攻击等

  - 本次学习了登录验证、预防XSS攻击和sql注入

- 集群和服务拆分

  - 如果产品发展速度快 , 流量会迅速增加 , 就需要考虑通过扩展机器和服务拆分的方式承载大流量

  - 本次学习是单机开发 , 但是从设计上支持服务拆分

---------------------------------------

# 博客项目后端部分

> Tips : 本次秉着学习的目的 , 并没有将技术方案设计地十分详尽 , 实际工作开发中需要更加详尽的技术方案

- 需求 : 开发博客系统的基本功能

  - 登录功能 : 登录页

  - 查看博客列表 : 首页 + 作者主页

  - 查看博客详情 : 博客详情页

  - 管理中心

    - 模糊查询

    - 撰写博客功能 : 新建页

    - 修改博客功能 : 编辑页

- 技术方案

  - 接口设计 ( 原则 : 路由和数据处理分离 )

    | 描述               | 接口             | 方法 | 参数                          | 备注                     |
    |:-------------------|:-----------------|:-----|:------------------------------|:-------------------------|
    | 获取博客列表       | /api/blog/list   | get  | author作者, keyword搜索关键字 | 参数为空则不进行查询过滤 |
    | 获取一篇博客的内容 | /api/blog/detail | get  | id                            |                          |
    | 新增一篇博客       | /api/blog/new    | post |                               | post中有新增的信息       |
    | 更新一篇博客       | /api/blog/update | post | id                            | postData中有更新的内容   |
    | 删除一篇博客       | /api/blog/del    | post | id                            |                          |
    | 登录               | /api/user/login  | post |                               | postData中有用户名和密码 |

  - 数据存储

    - 数据存储选用关系型数据库 [Mysql](https://dev.mysql.com/downloads/mysql/)

    - [SQL语句的的基本使用](https://blog.csdn.net/Brannua/article/details/104652438)

    - 配合使用mysql可视化客户端 [Mysql workbench](https://dev.mysql.com/downloads/workbench/)

      - user表的设计 ( 密码可进行加密处理 )

        | column   | datatype    | pk主键 | nn不为空 | ai自动增加 | Default |
        |:---------|:------------|:-------|:---------|:-----------|:--------|
        | id       | int         | Y      | Y        | Y          |         |
        | username | varchar(20) |        | Y        |            |         |
        | password | varchar(20) |        | Y        |            |         |
        | realname | varchar(10) |        | Y        |            |         |

      - blogs表的设计

        | column     | datatype    | pk主键 | nn不为空 | ai自动增加 | Default |
        |:-----------|:------------|:-------|:---------|:-----------|:--------|
        | id         | int         | Y      | Y        | Y          |         |
        | title      | varchar(50) |        | Y        |            |         |
        | content    | longtext    |        | Y        |            |         |
        | createtime | bigint(20)  |        | Y        |            | 0       |
        | author     | varchar(20) |        | Y        |            |         |

  - 登录部分 ( 业界有统一的解决方案 , 一般不用重新设计 )

    - 使用原生Node.js实现较为复杂 , 但是可以了解原理

    - 使用Koa2或express实现较为简单 , 但通过API无法了解原理
